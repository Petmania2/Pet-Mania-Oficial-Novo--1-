<!DOCTYPE html>
<html lang="pt-br">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   Pet Mania - Meu Perfil
  </title>
  <link href="/css/style-adestrador.css" rel="stylesheet"/>
  <link href="/css/style-perfil-novo.css" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet"/>
 </head>
 <body>
  <!-- Navbar -->
  <nav class="navbar" id="navbar">
   <section class="container navbar-container">
     <a href="/" class="logo">
    <img src="/imagens/petlogo.png" alt="Pet Mania" class="logo-img">
</a> 
    <button class="mobile-menu-btn" id="menuBtn">
     ☰
    </button>
    <ul class="nav-links" id="navLinks">
     <li>
     <a href="paineladestrador.ejs">
       <i class="fas fa-home">
       </i>
       Início
      </a>
     </li>
     <li>
      <a href="clientesadestrador.ejs">
       <i class="fas fa-user-friends">
       </i>
       Clientes
      </a>
     </li>
     <li>
      <a href="mensagensadestrador.ejs">
       <i class="fas fa-comments">
       </i>
       Mensagens
       <span class="notif-badge">
        3
       </span>
      </a>
     </li>
     <li>
      <a href="agendamentoadestrador.ejs">
       <i class="fas fa-calendar-alt">
       </i>
       Agendamentos
      </a>
     </li>
     <li>
      <a class="active" href="perfiladestrador.ejs"
        class="active"><i class="fas fa-user-circle">
       </i>
       Meu Perfil
      </a>
     </li>
     <li>
      <a href="planosadestrador.ejs">
       <i class="fas fa-star">
       </i>
       Planos
      </a>
     </li>
     <li>
      <a class="btn btn-logout" href="logout">
       <i class="fas fa-sign-out-alt">
       </i>
       Sair
      </a>
     </li>
    </ul>
   </section>
  </nav>
  <!-- Main Content -->
  <main class="main-content">
   <section class="container">
    <section class="profile-container">
     <header class="profile-header-new">
      <figure class="profile-avatar-new">
       <% if (adestrador && adestrador.ID_PERFIL && adestrador.ID_PERFIL > 0) { %>
         <img src="/imagem/<%= adestrador.ID_PERFIL %>" alt="Foto de perfil">
       <% } else { %>
         <section class="avatar-placeholder-new">
          <i class="fas fa-user"></i>
         </section>
       <% } %>
       <button class="change-avatar-btn-new">
        <i class="fas fa-camera"></i>
       </button>
      </figure>
      
      <section class="profile-info-new">
       <h1><%= adestrador && adestrador.NOME_USUARIO ? adestrador.NOME_USUARIO : 'Nome não informado' %></h1>
       <p class="profile-location-new">
        <i class="fas fa-map-marker-alt"></i>
        <%= adestrador && adestrador.cidade_adestrador ? adestrador.cidade_adestrador : 'Cidade' %>, <%= adestrador && adestrador.uf_adestrador ? adestrador.uf_adestrador : 'UF' %>
       </p>
       <section class="profile-rating-new">
        <section class="stars">
         <i class="fas fa-star"></i>
         <i class="fas fa-star"></i>
         <i class="fas fa-star"></i>
         <i class="fas fa-star"></i>
         <i class="fas fa-star-half-alt"></i>
        </section>
        <span>4.8 (38 avaliações)</span>
       </section>
       <button class="btn-edit-profile-new" id="editProfileBtn">
        <i class="fas fa-edit"></i>
        Editar Perfil
       </button>
      </section>
     </header>
     
     <!-- Add Media Section -->
     <section class="add-media-section">
      <button class="btn-add-media" id="addMediaBtn">
       <i class="fas fa-plus"></i>
       Adicionar Foto ou Vídeo
      </button>
     </section>
     
     <!-- Media Gallery -->
     <section class="media-gallery">
      <h2>Meus Trabalhos</h2>
      <section class="media-grid" id="mediaGrid">
       <!-- Media items will be added here -->
       <section class="media-placeholder">
        <i class="fas fa-camera"></i>
        <p>Adicione fotos e vídeos dos seus adestramentos</p>
       </section>
      </section>
     </section>
     
     <!-- Profile Edit Modal -->
     <section class="modal" id="profileEditModal">
      <section class="modal-content profile-modal">
       <header class="modal-header">
        <section class="modal-title">
         <i class="fas fa-user-edit"></i>
         <h2>Editar Meu Perfil</h2>
        </section>
        <button class="modal-close" id="closeProfileModal">
         <i class="fas fa-times"></i>
        </button>
       </header>
       <section class="modal-body">
        <section class="profile-tabs">
         <button class="tab-btn active" data-tab="personal">
          <i class="fas fa-user"></i>
          <span>Dados Pessoais</span>
         </button>
         <button class="tab-btn" data-tab="professional">
          <i class="fas fa-briefcase"></i>
          <span>Perfil Profissional</span>
         </button>
         <button class="tab-btn" data-tab="services">
          <i class="fas fa-cogs"></i>
          <span>Serviços</span>
         </button>
        </section>
      <section class="profile-tab-content active" id="personal-tab">
       <section class="form-section">
        <h3><i class="fas fa-id-card"></i> Informações Básicas</h3>
        <form class="profile-form">
         <section class="form-row">
          <section class="form-group">
           <label for="name">
            <i class="fas fa-user"></i>
            Nome Completo *
           </label>
           <input id="name" type="text" placeholder="Digite seu nome completo" value="<%= adestrador && adestrador.NOME_USUARIO ? adestrador.NOME_USUARIO : '' %>"/>
          </section>
          <section class="form-group">
           <label for="cpf">
            <i class="fas fa-id-badge"></i>
            CPF (não editável)
           </label>
           <input disabled="" id="cpf" type="text" value="<%= adestrador && adestrador.CPF_USUARIO ? adestrador.CPF_USUARIO : 'Não informado' %>"/>
          </section>
         </section>
         <section class="form-row">
          <section class="form-group">
           <label for="email">
            <i class="fas fa-envelope"></i>
            E-mail *
           </label>
           <input id="email" type="email" placeholder="seu@email.com" value="<%= adestrador && adestrador.EMAIL_USUARIO ? adestrador.EMAIL_USUARIO : '' %>"/>
          </section>
          <section class="form-group">
           <label for="phone">
            <i class="fas fa-phone"></i>
            Telefone/WhatsApp *
           </label>
           <input id="phone" type="text" placeholder="(11) 99999-9999" value="<%= adestrador && adestrador.CELULAR_USUARIO ? adestrador.CELULAR_USUARIO : '' %>"/>
          </section>
         </section>
        <section class="form-row">
         <section class="form-group">
          <label for="birth">
           Data de Nascimento
          </label>
          <input id="birth" type="date" value="<%= adestrador && adestrador.DATA_NASC_USUARIO ? adestrador.DATA_NASC_USUARIO : '' %>"/>
         </section>
         <section class="form-group">
          <label for="gender">
           Gênero
          </label>
          <select id="gender">
           <option value="male" <%= adestrador && adestrador.genero === 'masculino' ? 'selected' : '' %>>
            Masculino
           </option>
           <option value="female" <%= adestrador && adestrador.genero === 'feminino' ? 'selected' : '' %>>
            Feminino
           </option>
           <option value="other" <%= adestrador && adestrador.genero === 'outro' ? 'selected' : '' %>>
            Outro
           </option>
           <option value="prefer-not" <%= adestrador && adestrador.genero === 'nao-informar' ? 'selected' : '' %>>
            Prefiro não informar
           </option>
          </select>
         </section>
        </section>
        </form>
       </section>
       
       <section class="form-section">
        <h3><i class="fas fa-map-marker-alt"></i> Endereço</h3>
        <form class="profile-form">
         <section class="form-group">
          <label for="address">
           <i class="fas fa-road"></i>
           Logradouro
          </label>
          <input id="address" type="text" placeholder="Rua, Avenida, etc." value="<%= adestrador && adestrador.logradouro_adestrador ? adestrador.logradouro_adestrador : '' %>"/>
         </section>
        <section class="form-row">
         <section class="form-group">
          <label for="number">
           Número
          </label>
          <input id="number" type="text" value="<%= adestrador && adestrador.num_resid_adestrador ? adestrador.num_resid_adestrador : '' %>"/>
         </section>
         <section class="form-group">
          <label for="complement">
           Complemento
          </label>
          <input id="complement" type="text" value="<%= adestrador && adestrador.complemento_adestrador ? adestrador.complemento_adestrador : '' %>"/>
         </section>
        </section>
        <section class="form-group">
         <label for="neighborhood">
          Bairro
         </label>
         <input id="neighborhood" type="text" value="<%= adestrador && adestrador.bairro_adestrador ? adestrador.bairro_adestrador : '' %>"/>
        </section>
        <section class="form-row">
         <section class="form-group">
          <label for="city">
           Cidade
          </label>
          <input id="city" type="text" value="<%= adestrador && adestrador.cidade_adestrador ? adestrador.cidade_adestrador : '' %>"/>
         </section>
         <section class="form-group">
          <label for="state">
           Estado
          </label>
          <select id="state">
           <option value="">Selecione</option>
           <option value="AC" <%= adestrador && adestrador.uf_adestrador === 'AC' ? 'selected' : '' %>>Acre</option>
           <option value="AL" <%= adestrador && adestrador.uf_adestrador === 'AL' ? 'selected' : '' %>>Alagoas</option>
           <option value="AP" <%= adestrador && adestrador.uf_adestrador === 'AP' ? 'selected' : '' %>>Amapá</option>
           <option value="AM" <%= adestrador && adestrador.uf_adestrador === 'AM' ? 'selected' : '' %>>Amazonas</option>
           <option value="BA" <%= adestrador && adestrador.uf_adestrador === 'BA' ? 'selected' : '' %>>Bahia</option>
           <option value="CE" <%= adestrador && adestrador.uf_adestrador === 'CE' ? 'selected' : '' %>>Ceará</option>
           <option value="DF" <%= adestrador && adestrador.uf_adestrador === 'DF' ? 'selected' : '' %>>Distrito Federal</option>
           <option value="ES" <%= adestrador && adestrador.uf_adestrador === 'ES' ? 'selected' : '' %>>Espírito Santo</option>
           <option value="GO" <%= adestrador && adestrador.uf_adestrador === 'GO' ? 'selected' : '' %>>Goiás</option>
           <option value="MA" <%= adestrador && adestrador.uf_adestrador === 'MA' ? 'selected' : '' %>>Maranhão</option>
           <option value="MT" <%= adestrador && adestrador.uf_adestrador === 'MT' ? 'selected' : '' %>>Mato Grosso</option>
           <option value="MS" <%= adestrador && adestrador.uf_adestrador === 'MS' ? 'selected' : '' %>>Mato Grosso do Sul</option>
           <option value="MG" <%= adestrador && adestrador.uf_adestrador === 'MG' ? 'selected' : '' %>>Minas Gerais</option>
           <option value="PA" <%= adestrador && adestrador.uf_adestrador === 'PA' ? 'selected' : '' %>>Pará</option>
           <option value="PB" <%= adestrador && adestrador.uf_adestrador === 'PB' ? 'selected' : '' %>>Paraíba</option>
           <option value="PR" <%= adestrador && adestrador.uf_adestrador === 'PR' ? 'selected' : '' %>>Paraná</option>
           <option value="PE" <%= adestrador && adestrador.uf_adestrador === 'PE' ? 'selected' : '' %>>Pernambuco</option>
           <option value="PI" <%= adestrador && adestrador.uf_adestrador === 'PI' ? 'selected' : '' %>>Piauí</option>
           <option value="RJ" <%= adestrador && adestrador.uf_adestrador === 'RJ' ? 'selected' : '' %>>Rio de Janeiro</option>
           <option value="RN" <%= adestrador && adestrador.uf_adestrador === 'RN' ? 'selected' : '' %>>Rio Grande do Norte</option>
           <option value="RS" <%= adestrador && adestrador.uf_adestrador === 'RS' ? 'selected' : '' %>>Rio Grande do Sul</option>
           <option value="RO" <%= adestrador && adestrador.uf_adestrador === 'RO' ? 'selected' : '' %>>Rondônia</option>
           <option value="RR" <%= adestrador && adestrador.uf_adestrador === 'RR' ? 'selected' : '' %>>Roraima</option>
           <option value="SC" <%= adestrador && adestrador.uf_adestrador === 'SC' ? 'selected' : '' %>>Santa Catarina</option>
           <option value="SP" <%= adestrador && adestrador.uf_adestrador === 'SP' ? 'selected' : '' %>>São Paulo</option>
           <option value="SE" <%= adestrador && adestrador.uf_adestrador === 'SE' ? 'selected' : '' %>>Sergipe</option>
           <option value="TO" <%= adestrador && adestrador.uf_adestrador === 'TO' ? 'selected' : '' %>>Tocantins</option>
          </select>
         </section>
         <section class="form-group">
          <label for="cep">
           CEP
          </label>
          <input id="cep" type="text" value="<%= adestrador && adestrador.cep_ADESTRADOR ? adestrador.cep_ADESTRADOR : '' %>"/>
         </section>
        </section>
        </form>
       </section>
       
       <section class="form-actions-bottom">
        <button class="btn btn-secondary" type="button" onclick="document.getElementById('profileEditModal').style.display='none'">
         <i class="fas fa-times"></i>
         Cancelar
        </button>
        <button class="btn btn-primary btn-save" type="button">
         <i class="fas fa-save"></i>
         Salvar Alterações
        </button>
       </section>
      </section>
      <section class="profile-tab-content" id="professional-tab">
       <section class="form-section">
        <h3><i class="fas fa-briefcase"></i> Informações Profissionais</h3>
        <form class="profile-form">
         <section class="form-row">
          <section class="form-group">
           <label for="prof-title">
            <i class="fas fa-award"></i>
            Título Profissional
           </label>
           <input id="prof-title" type="text" placeholder="Ex: Adestrador Canino Certificado" value="<%= adestrador && adestrador.tituloProfissional ? adestrador.tituloProfissional : 'Adestrador Canino Profissional' %>"/>
          </section>
          <section class="form-group">
           <label for="experience">
            <i class="fas fa-calendar-alt"></i>
            Anos de Experiência
           </label>
           <input id="experience" type="number" min="0" max="50" placeholder="Ex: 5" value="<%= adestrador && adestrador.anos_experiencia ? adestrador.anos_experiencia : '' %>"/>
          </section>
         </section>
        <section class="form-group">
         <label for="bio">
          Biografia/Sobre Você
         </label>
         <textarea id="bio" rows="5"><%= adestrador && adestrador.sobre_sua_experiencia ? adestrador.sobre_sua_experiencia : 'Conte um pouco sobre sua experiência e metodologia de trabalho...' %></textarea>
        </section>
        <section class="form-group">
         <label for="certifications">
          Certificações e Formação
         </label>
         <textarea id="certifications" rows="3"><%= adestrador && adestrador.certificacoes ? adestrador.certificacoes : 'Adicione suas certificações e formações...' %></textarea>
        </section>
         <section class="form-group">
          <label for="price">
           <i class="fas fa-dollar-sign"></i>
           Preço por Sessão (R$) *
          </label>
          <input id="price" type="number" step="0.01" min="50" placeholder="120.00" value="<%= adestrador && adestrador.valor_sessao ? adestrador.valor_sessao : '' %>"/>
         </section>
        
        <section class="form-group">
          <label>
           Especialidades
          </label>
          <section class="checkbox-group">
           <% 
           // Mapear as especialidades do banco para os valores corretos
           const especialidadesDisponiveis = [
             { valor: 'obediencia-basica', nome: 'Obediência Básica' },
             { valor: 'comportamento', nome: 'Problemas de Comportamento' },
             { valor: 'truques', nome: 'Truques e Comandos' },
             { valor: 'agressividade', nome: 'Controle de Agressividade' },
             { valor: 'filhotes', nome: 'Treinamento de Filhotes' }
           ];
           
           // Garantir que especialidades seja um array
           let especialidadesUsuario = [];
           if (adestrador && adestrador.especialidades) {
             if (Array.isArray(adestrador.especialidades)) {
               especialidadesUsuario = adestrador.especialidades;
             } else if (typeof adestrador.especialidades === 'string') {
               try {
                 especialidadesUsuario = JSON.parse(adestrador.especialidades);
               } catch (e) {
                 especialidadesUsuario = [];
               }
             }
           }
           %>
           
           <% especialidadesDisponiveis.forEach(function(especialidade) { %>
             <label class="checkbox-item">
              <input 
                type="checkbox" 
                name="specialty" 
                value="<%= especialidade.valor %>"
                <%= especialidadesUsuario.includes(especialidade.valor) ? 'checked' : '' %>
              />
              <%= especialidade.nome %>
             </label>
           <% }); %>
          </section>
         </section>
        </form>
       </section>
       
       <section class="form-actions-bottom">
        <button class="btn btn-secondary" type="button" onclick="document.getElementById('profileEditModal').style.display='none'">
         <i class="fas fa-times"></i>
         Cancelar
        </button>
        <button class="btn btn-primary btn-save" type="button">
         <i class="fas fa-save"></i>
         Salvar Alterações
        </button>
       </section>
      </section>
      
      <section class="profile-tab-content" id="services-tab">
       <section class="form-section">
        <h3><i class="fas fa-cogs"></i> Gerenciar Serviços</h3>
        <section class="services-manager">
         <section class="services-list-modal" id="servicesListModal">
          <section class="service-placeholder-modal">
           <i class="fas fa-briefcase"></i>
           <p>Nenhum serviço cadastrado</p>
           <button class="btn-add-service-modal" id="addServiceModalBtn">
            <i class="fas fa-plus"></i>
            Adicionar Primeiro Serviço
           </button>
          </section>
         </section>
        </section>
       </section>
       
       <section class="form-actions-bottom">
        <button class="btn btn-secondary" type="button" onclick="document.getElementById('profileEditModal').style.display='none'">
         <i class="fas fa-times"></i>
         Cancelar
        </button>
       </section>
      </section>
      </section>
     </section>
     

     
     <!-- Statistics Section -->
     <section class="profile-stats">
      <h2>Estatísticas</h2>
      <section class="stats-grid">
       <article class="stat-card">
        <i class="fas fa-eye"></i>
        <h3>432</h3>
        <p>Visualizações</p>
       </article>
       <article class="stat-card">
        <i class="fas fa-heart"></i>
        <h3>98%</h3>
        <p>Taxa de Resposta</p>
       </article>
       <article class="stat-card">
        <i class="fas fa-users"></i>
        <h3>76%</h3>
        <p>Conversão</p>
       </article>
      </section>
     </section>
    </section>
   </section>
  </main>
  <!-- Floating Notification Button -->
  <section class="notification-float">
   <i class="fas fa-bell">
   </i>
   <span class="notif-count">
    3
   </span>
  </section>
  <!-- Media Upload Modal -->
  <section class="modal" id="mediaModal">
   <section class="modal-content">
    <header class="modal-header">
     <h2>Adicionar Mídia</h2>
     <button class="modal-close" id="closeModal">&times;</button>
    </header>
    <section class="modal-body">
     <form id="mediaUploadForm">
      <section class="upload-area">
       <i class="fas fa-cloud-upload-alt"></i>
       <p>Arraste arquivos aqui ou clique para selecionar</p>
       <input type="file" id="mediaInput" accept="image/*,video/*" multiple>
      </section>
      <section class="form-group">
       <label for="mediaDescription">Descrição</label>
       <textarea id="mediaDescription" placeholder="Descreva este trabalho..."></textarea>
      </section>
      <section class="modal-actions">
       <button type="button" class="btn btn-secondary" id="cancelUpload">Cancelar</button>
       <button type="submit" class="btn btn-primary">Adicionar</button>
      </section>
     </form>
    </section>
   </section>
  </section>
  
  <!-- Service Modal -->
  <section class="modal" id="serviceModal">
   <section class="modal-content">
    <header class="modal-header">
     <h2>Adicionar Serviço</h2>
     <button class="modal-close" id="closeServiceModal">&times;</button>
    </header>
    <section class="modal-body">
     <form id="serviceForm">
      <section class="form-group">
       <label for="serviceName">Nome do Serviço</label>
       <input type="text" id="serviceName" placeholder="Ex: Adestramento Básico" required>
      </section>
      <section class="form-group">
       <label for="servicePrice">Preço (R$)</label>
       <input type="number" id="servicePrice" step="0.01" placeholder="120.00" required>
      </section>
      <section class="form-group">
       <label for="serviceDuration">Duração</label>
       <input type="text" id="serviceDuration" placeholder="1h30min" required>
      </section>
      <section class="form-group">
       <label for="serviceDescription">Descrição</label>
       <textarea id="serviceDescription" placeholder="Descreva o que está incluído neste serviço..." required></textarea>
      </section>
      <section class="modal-actions">
       <button type="button" class="btn btn-secondary" id="cancelService">Cancelar</button>
       <button type="submit" class="btn btn-primary">Adicionar Serviço</button>
      </section>
     </form>
    </section>
   </section>
  </section>
  
  <script src="/js/script-adestrador.js"></script>
  <script src="/js/script-perfil.js"></script>
  <script>
   // Profile edit modal
   const editProfileBtn = document.getElementById('editProfileBtn');
   const profileModal = document.getElementById('profileEditModal');
   const closeProfileModal = document.getElementById('closeProfileModal');
   
   editProfileBtn.addEventListener('click', () => {
    profileModal.style.display = 'flex';
   });
   
   closeProfileModal.addEventListener('click', () => {
    profileModal.style.display = 'none';
   });
   
   profileModal.addEventListener('click', (e) => {
    if (e.target === profileModal) {
     profileModal.style.display = 'none';
    }
   });
   
   // Tab functionality
   document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
     const targetTab = btn.getAttribute('data-tab');
     
     // Remove active class from all tabs and contents
     document.querySelectorAll('.tab-btn').forEach(t => t.classList.remove('active'));
     document.querySelectorAll('.profile-tab-content').forEach(c => c.classList.remove('active'));
     
     // Add active class to clicked tab and corresponding content
     btn.classList.add('active');
     document.getElementById(targetTab + '-tab').classList.add('active');
    });
   });
   
   // Upload de foto de perfil
   const changeAvatarBtn = document.querySelector('.change-avatar-btn-new');
   if (changeAvatarBtn) {
   changeAvatarBtn.addEventListener('click', function() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = 'image/*';
    input.onchange = function(e) {
     const file = e.target.files[0];
     if (file) {
      const formData = new FormData();
      formData.append('foto', file);
      
      fetch('/upload-foto-perfil', {
       method: 'POST',
       body: formData
      })
      .then(response => response.json())
      .then(data => {
       if (data.sucesso) {
        location.reload();
       } else {
        alert('Erro: ' + data.erro);
       }
      })
      .catch(error => {
       console.error('Erro:', error);
       alert('Erro ao fazer upload da foto');
      });
     }
    };
    input.click();
   });
   }
   
   // Media modal
   const addMediaBtn = document.getElementById('addMediaBtn');
   const mediaModal = document.getElementById('mediaModal');
   const closeModal = document.getElementById('closeModal');
   const cancelUpload = document.getElementById('cancelUpload');
   
   addMediaBtn.addEventListener('click', () => {
    mediaModal.style.display = 'flex';
   });
   
   [closeModal, cancelUpload].forEach(btn => {
    btn.addEventListener('click', () => {
     mediaModal.style.display = 'none';
    });
   });
   
   // File upload handling
   const mediaInput = document.getElementById('mediaInput');
   const uploadArea = document.querySelector('.upload-area');
   
   uploadArea.addEventListener('click', () => mediaInput.click());
   
   uploadArea.addEventListener('dragover', (e) => {
    e.preventDefault();
    uploadArea.classList.add('dragover');
   });
   
   uploadArea.addEventListener('dragleave', () => {
    uploadArea.classList.remove('dragover');
   });
   
   uploadArea.addEventListener('drop', (e) => {
    e.preventDefault();
    uploadArea.classList.remove('dragover');
    const files = e.dataTransfer.files;
    handleFiles(files);
   });
   
   mediaInput.addEventListener('change', (e) => {
    handleFiles(e.target.files);
   });
   
   function handleFiles(files) {
    const mediaGrid = document.getElementById('mediaGrid');
    const placeholder = mediaGrid.querySelector('.media-placeholder');
    
    Array.from(files).forEach(file => {
     if (file.type.startsWith('image/') || file.type.startsWith('video/')) {
      const reader = new FileReader();
      reader.onload = (e) => {
       const mediaItem = document.createElement('article');
       mediaItem.className = 'media-item';
       
       if (file.type.startsWith('image/')) {
        mediaItem.innerHTML = `
         <img src="${e.target.result}" alt="Trabalho">
         <section class="media-overlay">
          <button class="btn-delete"><i class="fas fa-trash"></i></button>
         </section>
        `;
       } else {
        mediaItem.innerHTML = `
         <video src="${e.target.result}" controls></video>
         <section class="media-overlay">
          <button class="btn-delete"><i class="fas fa-trash"></i></button>
         </section>
        `;
       }
       
       if (placeholder) {
        mediaGrid.removeChild(placeholder);
       }
       mediaGrid.appendChild(mediaItem);
      };
      reader.readAsDataURL(file);
     }
    });
    
    mediaModal.style.display = 'none';
   }
   
   // Delete media item
   document.addEventListener('click', function(e) {
    if (e.target.closest('.btn-delete')) {
     const mediaItem = e.target.closest('.media-item');
     if (confirm('Deseja remover esta mídia?')) {
      mediaItem.remove();
     }
    }
   });
   
   // Service modal
   const addServiceBtn = document.getElementById('addServiceBtn');
   const addServiceModalBtn = document.getElementById('addServiceModalBtn');
   const addServiceFromModal = document.getElementById('addServiceFromModal');
   const serviceModal = document.getElementById('serviceModal');
   const closeServiceModal = document.getElementById('closeServiceModal');
   const cancelService = document.getElementById('cancelService');
   const serviceForm = document.getElementById('serviceForm');
   
   [addServiceBtn, addServiceModalBtn, addServiceFromModal].forEach(btn => {
    if (btn) {
     btn.addEventListener('click', () => {
      serviceModal.style.display = 'flex';
     });
    }
   });
   
   [closeServiceModal, cancelService].forEach(btn => {
    btn.addEventListener('click', () => {
     serviceModal.style.display = 'none';
     serviceForm.reset();
    });
   });
   
   serviceForm.addEventListener('submit', (e) => {
    e.preventDefault();
    
    const name = document.getElementById('serviceName').value;
    const price = document.getElementById('servicePrice').value;
    const duration = document.getElementById('serviceDuration').value;
    const description = document.getElementById('serviceDescription').value;
    
    const servicesGrid = document.getElementById('servicesGrid');
    const placeholder = servicesGrid.querySelector('.service-placeholder');
    
    const serviceItem = document.createElement('article');
    serviceItem.className = 'service-card';
    serviceItem.innerHTML = `
     <section class="service-header">
      <h3>${name}</h3>
      <section class="service-price">R$ ${parseFloat(price).toFixed(2).replace('.', ',')}</section>
     </section>
     <p>${description}</p>
     <section class="service-details">
      <span><i class="fas fa-clock"></i> ${duration}</span>
     </section>
     <section class="service-actions">
      <button class="btn-edit-service"><i class="fas fa-edit"></i></button>
      <button class="btn-delete-service"><i class="fas fa-trash"></i></button>
     </section>
    `;
    
    if (placeholder && servicesGrid.children.length === 1) {
     servicesGrid.removeChild(placeholder);
    }
    
    servicesGrid.appendChild(serviceItem);
    serviceModal.style.display = 'none';
    serviceForm.reset();
   });
   
   // Delete service
   document.addEventListener('click', function(e) {
    if (e.target.closest('.btn-delete-service')) {
     const serviceCard = e.target.closest('.service-card');
     if (confirm('Deseja remover este serviço?')) {
      serviceCard.remove();
      
      const servicesGrid = document.getElementById('servicesGrid');
      if (servicesGrid.children.length === 0) {
       const placeholder = document.createElement('section');
       placeholder.className = 'service-placeholder';
       placeholder.innerHTML = `
        <i class="fas fa-plus"></i>
        <p>Adicione seus serviços personalizados</p>
        <button class="btn-add-service" id="addServiceBtn">
         <i class="fas fa-plus"></i>
         Adicionar Serviço
        </button>
       `;
       servicesGrid.appendChild(placeholder);
      }
     }
    }
   });
  </script>


 </body>
</html>